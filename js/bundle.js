var Navbar=React.createClass({displayName:"Navbar",render:function(){return React.createElement("div",{className:"ui top fixed menu"},React.createElement("div",{className:"ui container content"},React.createElement("div",{className:"item"},"選課模擬系統")))}});
var CourseSelection=React.createClass({displayName:"CourseSelection",getInitialState:function(){if(window.location.search.length<=0)return{list:[]};if(parameters={},window.location.search.substring(1).split("&").map(function(e){token=e.split("="),parameters[token[0]]=token[1]}),!parameters.data)return{list:[]};try{var e=JSURL.parse(atob(parameters.data));return{list:e}}catch(t){return{parseError:!0,list:[]}}},isConflictCheck:function(e,t){for(var a=0;a<e.length;a++)for(var c=0;c<e[a].courseTime.length;c++)if(t.courseTime.indexOf(e[a].courseTime[c])>=0)return $("#conflictCourse").append("<p>欲加選的課程：<br/>").append(t.courseTime.toString()+" : "+t.courseName).append("</p><p>已與課表上下列課程時間重疊：<br/>").append(e[a].courseTime.toString()+" : "+e[a].courseName).append("</p>"),$(".ui.modal.conflictWarning").modal("show"),!0;return!1},handleAddCourse:function(e,t){var a=this.state.list;this.isConflictCheck(a,e)||(a.push(e),this.setState({list:a}),setTimeout(function(){t.html("Added").addClass("disabled")},600)),setTimeout(function(){t.removeClass("loading")},600)},handleDelete:function(e){this.setState({list:this.state.list.filter(function(t){return t.courseUid!=e})})},render:function(){return React.createElement("div",{id:"CourseSelection"},React.createElement("div",{className:"ui parseError warning message hidden"},React.createElement("i",{className:"close icon"}),React.createElement("div",{className:"header"},"網址解析失敗"),React.createElement("p",null,"無法從網址讀取資料。因此課表將顯示為空白")),React.createElement("div",{className:"ui top attached secondary pointing menu"},React.createElement("a",{className:"active item","data-tab":"schedule"},"我的課表"),React.createElement("a",{className:"item","data-tab":"search"},"搜尋課程"),React.createElement("a",{className:"item","data-tab":"about"},"About")),React.createElement("div",{className:"ui bottom attached tab segment active content","data-tab":"schedule"},React.createElement(CourseTable,{courseList:this.state.list,handleDelete:this.handleDelete})),React.createElement("div",{className:"ui bottom attached tab segment","data-tab":"search"},React.createElement(SearchCourse,{handleAddCourse:this.handleAddCourse})),React.createElement("div",{className:"ui bottom attached tab segment","data-tab":"about"},React.createElement("h2",{className:"ui dividing header"},"關於"),React.createElement("h3",{className:"ui header"},"作者"),React.createElement("div",{className:"ui list"},React.createElement("div",{className:"item"},React.createElement("img",{className:"ui avatar image",src:"http://www.gravatar.com/avatar/7bc81b728640a4917ec3b6625d16425e"}),React.createElement("div",{className:"content"},React.createElement("a",{className:"header"},"Erickson Juang"),React.createElement("div",{className:"description"},"資訊工程學系102級(104~)、電機工程學系101級(101~103)")))),React.createElement("h3",{className:"ui header"},"更新資訊"),React.createElement("ul",null,React.createElement("li",null,"2015-12-09",React.createElement("ul",null,React.createElement("li",null,"更新為1042學期資料庫"))),React.createElement("li",null,"2015-09-10",React.createElement("ul",null,React.createElement("li",null,"更新資料庫 （節戳時間為2015-09-09 22:38:53）"),React.createElement("li",null,"衝堂提醒增加列出衝堂課名與時間"),React.createElement("li",null,"課程資料增加上課地點"),React.createElement("li",null,"課表中顯示課號與上課地點"),React.createElement("li",null,"按下「Add」後，按鈕改為disabled"),React.createElement("li",null,"更改UI文字"),React.createElement("li",null,"統計已選學分數")))),React.createElement("h3",{className:"ui header"},"注意事項"),React.createElement("div",{className:"ui bulleted list"},React.createElement("div",{className:"item"},"課程資訊僅供參考，實際資訊請參閱",React.createElement("a",{href:"https://portal.yzu.edu.tw/cosSelect/Index.aspx"},"元智大學課程查詢系統"),"。")),React.createElement("h3",{className:"ui header"},"使用的Framework"),React.createElement("div",{className:"ui bulleted list"},React.createElement("div",{className:"item"},"React 0.13.3"),React.createElement("div",{className:"item"},"Semantic ui 2.0.8"),React.createElement("div",{className:"item"},"jsurl.js"),React.createElement("div",{className:"item"},"jQuery")),React.createElement("h3",{className:"ui header"},"原始碼與授權"),React.createElement("div",{className:"ui list"},React.createElement("div",{className:"ui items"},React.createElement("div",{className:"item"},React.createElement("div",{className:"ui mini image"},React.createElement("i",{className:"big github icon"})),React.createElement("div",{className:"content"},React.createElement("div",{className:"header"},"Source code on Github"),React.createElement("div",{className:"description"},React.createElement("p",null,"可以由Github上觀看source code"),React.createElement("p",null,React.createElement("a",{href:"https://github.com/erickson-makotoki/yzu-css"},"https://github.com/erickson-makotoki/yzu-css"))))),React.createElement("div",{className:"item"},React.createElement("div",{className:"ui mini image"},React.createElement("i",{className:"big code icon"})),React.createElement("div",{className:"content"},React.createElement("div",{className:"header"},"MIT 授權"),React.createElement("div",{className:"description"},React.createElement("p",null,"可參閱",React.createElement("a",{href:"http://www.openfoundry.org/tw/licenses/34-mit-licensemit"},"http://www.openfoundry.org/tw/licenses/34-mit-licensemit")))))))),React.createElement("div",{className:"ui basic modal conflictWarning"},React.createElement("i",{className:"close icon"}),React.createElement("div",{className:"header"},"糟糕，衝堂了"),React.createElement("div",{className:"image content"},React.createElement("div",{className:"image"},React.createElement("i",{className:"warning circle icon"})),React.createElement("div",{className:"description"},React.createElement("p",null,"此課程開課時間，和你已經選的課有重疊喔！"),React.createElement("div",{id:"conflictCourse"}))),React.createElement("div",{className:"actions"},React.createElement("div",{className:"ui green basic inverted button"},React.createElement("i",{className:"checkmark icon"}),"OK"))))},componentDidMount:function(){$(".message.parseError.warning .close").on("click",function(){$(this).closest(".message").transition("fade")}),this.state.parseError&&$(".message.parseError.warning").show()}}),CourseTable=React.createClass({displayName:"CourseTable",getInitialState:function(){return{day:6,row:13,label:{times:["08:10-09:00","09:10-10:00","10:10-11:00","11:10-12:00","12:10-13:00","13:10-14:00","14:10-15:00","15:10-16:00","16:10-17:00","17:10-18:00","18:30-19:20","19:30-20:20","20:30-21:20"],days:["Mon","Tue","Wed","Thu","Fri","Sat"]},creditCount:0}},handleDaysChange:function(e){return e?void this.setState({day:e}):!1},handleLessonsChange:function(e){return e?void this.setState({row:e}):!1},handleDelete:function(e){this.props.handleDelete(e)},refreshData:function(e){var t={},a=0;e.map(function(e){a+=e.credit,e.courseTime.map(function(a){Math.floor(a/100)>this.state.day&&$(".dropdown.daysOption").dropdown("set selected",Math.floor(a/100)),a%100>this.state.row&&$(".dropdown.lessonsOption").dropdown("set selected",a%100),t[Math.floor(a/100-1).toString()]=t[Math.floor(a/100-1).toString()]||{},t[Math.floor(a/100-1).toString()][(a%100-1).toString()]=e}.bind(this))}.bind(this)),this.setState({rawData:e,extendData:t,creditCount:a})},componentWillReceiveProps:function(e){this.refreshData(e.courseList)},componentWillMount:function(){this.refreshData(this.props.courseList)},render:function(){var e,t,a,c=[5,6].map(function(e){return React.createElement("option",{key:e,value:e},e)}.bind(this)),n=[4,5,6,7,8,9,10,11,12,13].map(function(e){return React.createElement("option",{key:e,value:e},e," (",this.state.label.times[e-1].split("-")[1],"結束)")}.bind(this));a=this.state.label.days.map(function(e,t){return t+1>this.state.day?null:React.createElement("th",{key:t+1,className:"two wide center aligned"},e)}.bind(this)),a.unshift(React.createElement("th",{key:0,className:"two wide"})),e=React.createElement("thead",null,React.createElement("tr",{key:0},a));var l=this.state.label.times.map(function(e,t){return t+1>this.state.row?null:(a=Array.apply(null,Array(this.state.day)).map(function(e,a){return this.state.extendData&&this.state.extendData[a.toString()]&&this.state.extendData[a.toString()][t.toString()]?React.createElement(CourseTableDataField,{key:a+1,course:this.state.extendData[a.toString()][t.toString()],handleDelete:this.handleDelete,fieldKey:(a+1).toString()+(t+1>=10?(t+1).toString():"0"+(t+1))}):React.createElement(CourseTableDataField,{key:a+1})}.bind(this)),a.unshift(React.createElement("td",{key:0,className:"center aligned"},React.createElement("p",{key:0},"第 ",t+1," 節"),React.createElement("p",{key:1},e))),React.createElement("tr",{key:t+1},a))}.bind(this));return t=React.createElement("tbody",null,l),React.createElement("div",null,React.createElement("div",{className:"ui form"},React.createElement("div",{className:"three fields"},React.createElement("div",{className:"field"},React.createElement("select",{defaultValue:this.state.day,className:"ui dropdown daysOption"},c),React.createElement("label",null,"一週上課幾天？")),React.createElement("div",{className:"field"},React.createElement("select",{defaultValue:this.state.row,className:"ui dropdown lessonsOption"},n),React.createElement("label",null,"一天最多幾節課？")),React.createElement("div",{className:"field"},React.createElement("div",{className:"teal ui button generatingURL",onClick:this.generatingURL,"data-content":"匯出課表，下次可以由該網址繼續編輯。"},"產生網址")))),React.createElement("div",{className:"ui green message"},React.createElement("p",null,"已選學分數：",this.state.creditCount),React.createElement("p",null,"一般生選課上限為25學分，符合資格者（如雙主修、輔系、跨學程領域等）上限為31學分"),React.createElement("p",null,"大一～大三生選課下限至少16學分，大四生至少9學分")),React.createElement("table",{id:"CourseTable",className:"ui definition table celled"},e,t),React.createElement("div",{className:"ui modal basic generatingURL"},React.createElement("i",{className:"close icon"}),React.createElement("div",{className:"header"},"產生網址"),React.createElement("div",{className:"ui input fluid"},React.createElement("input",{type:"text",ref:"url",readOnly:!0}),React.createElement("a",{target:"_blank",className:"ui teal right labeled icon button",ref:"url_button"},React.createElement("i",{className:"linkify icon"}),"Open"))))},componentDidMount:function(){$(".ui.button").popup({position:"bottom center"}),$("select.dropdown.daysOption").dropdown({onChange:this.handleDaysChange}),$("select.dropdown.lessonsOption").dropdown({onChange:this.handleLessonsChange})},generatingURL:function(){var e=btoa(JSURL.stringify(this.state.rawData));React.findDOMNode(this.refs.url).value=window.location.protocol+"//"+window.location.host+window.location.pathname+"?data="+e,React.findDOMNode(this.refs.url_button).href=window.location.protocol+"//"+window.location.host+window.location.pathname+"?data="+e,$(".modal.generatingURL").modal("show")}}),CourseTableDataField=React.createClass({displayName:"CourseTableDataField",render:function(){return this.props.course?React.createElement("td",null,React.createElement("div",{className:"right aligned"},React.createElement("a",{href:"#",onClick:this.handleDelete},React.createElement("i",{className:"close icon"}))),React.createElement("p",{className:"center aligned"},this.props.course.courseCode+" "+this.props.course.classNumber,React.createElement("br",null),this.props.course.courseName,React.createElement("br",null),this.props.course.teacherName,React.createElement("br",null),this.props.course.classroom[this.props.fieldKey])):React.createElement("td",null)},handleDelete:function(){this.props.handleDelete(this.props.course.courseUid)}}),SearchCourse=React.createClass({displayName:"SearchCourse",getInitialState:function(){return $.ajax({url:"database104-2.json",type:"get",dataType:"json"}).done(function(e,t,a){this.setState({courseData:e})}.bind(this)).fail(function(e,t,a){}),{degree:[1,2,3,4],reslut:{}}},handleSearchFormSubmit:function(e){var t=this.state.courseData.course;e.department&&"0"!=e.department&&(t=t.filter(function(t,a,c){return t.department==e.department})),e.degree&&"0"!=e.degree&&(t=t.filter(function(t,a,c){return t.degree==e.degree})),e.courseCode&&(t=t.filter(function(t,a,c){return t.code.indexOf(e.courseCode)>=0})),e.courseName&&(t=t.filter(function(t,a,c){return t.chinese_name.indexOf(e.courseName)>=0})),e.teacherName&&(t=t.filter(function(t,a,c){return t.teacher.indexOf(e.teacherName)>=0})),this.setState({result:t})},handleCourseAdd:function(e,t){this.props.handleAddCourse({courseUid:e.uid,courseCode:e.code,courseName:e.chinese_name,teacherName:e.teacher,courseTime:e.time.split(",").map(function(e){return parseInt(e)}),classroom:e.classroom,classNumber:e["class"],credit:e.credit},t)},render:function(){return this.state.courseData?React.createElement("div",{className:"ui grid stackable"},React.createElement("div",{className:"six wide column"},React.createElement(SearchForm,{degree:this.state.degree,department:this.state.courseData.department,updateTime:this.state.courseData.update,handleSubmit:this.handleSearchFormSubmit})),React.createElement("div",{className:"ten wide column searchResult"},React.createElement(SearchResult,{result:this.state.result,handleAdd:this.handleCourseAdd}))):null}}),SearchForm=React.createClass({displayName:"SearchForm",getInitialState:function(){return{department:0,degree:0}},handleDepartmentChange:function(e){e&&this.setState({department:e})},handleGradeChange:function(e){e&&this.setState({degree:e})},handleReset:function(){$("form").removeClass("error"),0!=this.state.department&&$(".dropdown.department").dropdown("restore defaults"),0!=this.state.degree&&$(".dropdown.degree").dropdown("restore defaults")},handleSubmit:function(e){$("form").removeClass("error"),e.preventDefault();var t={department:this.state.department,degree:this.state.degree,courseCode:React.findDOMNode(this.refs.courseCode).value.trim()||null,courseName:React.findDOMNode(this.refs.courseName).value.trim()||null,teacherName:React.findDOMNode(this.refs.teacherName).value.trim()||null};0!=t.department||0!=t.degree||t.courseCode||t.courseName||t.teacherName?this.props.handleSubmit(t):$("form").addClass("error"),$('button[class="ui green basic button disabled"]').html("Add"),$('button[class="ui green basic button disabled"]').removeClass("disabled")},render:function(){var e=this.props.department.map(function(e,t){return React.createElement("option",{key:t+1,value:e.departmentCode},e.departmentName)});e.unshift(React.createElement("option",{key:0,value:0},"請選擇 Please Select"));var t=this.props.degree.map(function(e,t){return React.createElement("option",{key:t+1,value:e},e)});return t.unshift(React.createElement("option",{key:0,value:0},"請選擇 Please Select")),React.createElement("form",{className:"ui form",onSubmit:this.handleSubmit},React.createElement("h2",{className:"ui dividing header"},"搜尋課程"),React.createElement("div",{className:"ui error message"},React.createElement("div",{className:"header"},"缺少搜尋條件"),React.createElement("p",null,"請至少指定一個搜尋條件，再進行搜尋。")),React.createElement("div",{className:"field"},React.createElement("label",null,"開課系所 Department"),React.createElement("select",{defaultValue:this.state.department,className:"ui dropdown search department"},e)),React.createElement("div",{className:"field"},React.createElement("label",null,"選課年級 Grade"),React.createElement("select",{defaultValue:this.state.degree,className:"ui dropdown degree"},t)),React.createElement("div",{className:"field"},React.createElement("label",null,"課號"),React.createElement("input",{type:"text",placeholder:"Course Code",ref:"courseCode"})),React.createElement("div",{className:"field"},React.createElement("label",null,"課程名稱"),React.createElement("input",{type:"text",placeholder:"Course Name",ref:"courseName"})),React.createElement("div",{className:"field"},React.createElement("label",null,"開課教師"),React.createElement("input",{type:"text",placeholder:"Teacher Name",ref:"teacherName"})),React.createElement("div",{className:"field"},React.createElement("label",null,"資料庫最後更新時間"),this.props.updateTime),React.createElement("div",{className:"field right aligned"},React.createElement("div",{className:"ui buttons"},React.createElement("button",{type:"reset",className:"ui button reset",onClick:this.handleReset},"Reset"),React.createElement("div",{className:"or"}),React.createElement("button",{type:"submit",className:"ui positive button"},"Search"))))},componentDidMount:function(){$("select.dropdown.department").dropdown({onChange:this.handleDepartmentChange}),$("select.dropdown.degree").dropdown({onChange:this.handleGradeChange})}}),SearchResult=React.createClass({displayName:"SearchResult",handleAdd:function(e){var t=$(React.findDOMNode(this.refs["result-"+e.uid]));t.addClass("loading"),this.props.handleAdd(e,t)},render:function(){if(!this.props.result)return null;if(this.props.result.length>0){var e=this.props.result.map(function(e,t){return React.createElement("tr",{key:t},React.createElement("td",null,React.createElement("a",{href:e.url,target:"_blank",className:"courseCode","data-content":"點選可連結至學校課程系統，觀看課程大綱。"},e.code)),React.createElement("td",null,e.teacher),React.createElement("td",null,e.chinese_name),React.createElement("td",null,e.credit),React.createElement("td",null,e.time),React.createElement("td",null,e.degree),React.createElement("td",null,React.createElement("button",{className:"ui green basic button",onClick:this.handleAdd.bind(this,e),ref:"result-"+e.uid},"Add")))}.bind(this));return React.createElement("div",{className:"ui"},React.createElement("h2",{className:"ui dividing header"},"搜尋結果"),React.createElement("table",{className:"ui striped table"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{className:"one wide"},"課號"),React.createElement("th",{className:"two wide"},"開課教師"),React.createElement("th",{className:"three wide"},"課程名稱"),React.createElement("th",{className:"one wide"},"學分"),React.createElement("th",{className:"one wide"},"時間"),React.createElement("th",{className:"one wide"},"可選年級"),React.createElement("th",{className:"one wide"},"Add"))),React.createElement("tbody",null,e)))}return React.createElement("div",{className:"ui"},React.createElement("h2",{className:"ui dividing header"},"搜尋結果"),React.createElement("div",{className:"warning ui message"},React.createElement("div",{className:"header"},"沒有符合條件的資料"),React.createElement("ul",{className:"list"},React.createElement("li",null,"關鍵字錯誤？（例如在課號中輸入課程名稱）"),React.createElement("li",null,"嘗試減少關鍵字，改用系所和年級查詢"))))},componentDidUpdate:function(){$(".courseCode").popup({position:"bottom center"})}});$(document).ready(function(){$(".menu .item").tab()});
var MainContent=React.createClass({displayName:"MainContent",getInitialState:function(){return{page:"CSS"}},render:function(){switch(this.state.page){case"CSS":return React.createElement(CourseSelection,null)}}}),MainContainer=React.createClass({displayName:"MainContainer",render:function(){return React.createElement("div",{id:"MainContainer"},React.createElement(Navbar,null),React.createElement("div",{className:"content"},React.createElement(MainContent,null)))}});React.render(React.createElement(MainContainer,null),document.getElementsByTagName("body")[0]);